-- Aerospace Supplier Scoring SQL
-- Generated from scoring.yaml and negative_signals.yaml

-- Scoring for planet_osm_point
SELECT *,
    (
    CASE
    WHEN (operator IN ('i', 's', '_', 'n', 'o', 't', '_', 'n', 'u', 'l', 'l')) THEN 80
    WHEN (operator IN ('i', 's', '_', 'n', 'o', 't', '_', 'n', 'u', 'l', 'l')) THEN 50
    ELSE 0
END +
    CASE WHEN (LOWER(name) LIKE LOWER('%boeing%') OR LOWER(name) LIKE LOWER('%airbus%') OR LOWER(name) LIKE LOWER('%rolls royce%') OR LOWER(name) LIKE LOWER('%bae systems%') OR LOWER(name) LIKE LOWER('%leonardo%') OR LOWER(name) LIKE LOWER('%thales%') OR LOWER(name) LIKE LOWER('%safran%') OR LOWER(operator) LIKE LOWER('%boeing%') OR LOWER(operator) LIKE LOWER('%airbus%') OR LOWER(operator) LIKE LOWER('%rolls royce%') OR LOWER(operator) LIKE LOWER('%bae systems%') OR LOWER(operator) LIKE LOWER('%leonardo%') OR LOWER(operator) LIKE LOWER('%thales%') OR LOWER(operator) LIKE LOWER('%safran%') OR LOWER(brand) LIKE LOWER('%boeing%') OR LOWER(brand) LIKE LOWER('%airbus%') OR LOWER(brand) LIKE LOWER('%rolls royce%') OR LOWER(brand) LIKE LOWER('%bae systems%') OR LOWER(brand) LIKE LOWER('%leonardo%') OR LOWER(brand) LIKE LOWER('%thales%') OR LOWER(brand) LIKE LOWER('%safran%')) THEN 50 ELSE 0 END +
    CASE WHEN (LOWER(name) LIKE LOWER('%aerospace%') OR LOWER(name) LIKE LOWER('%aviation%') OR LOWER(name) LIKE LOWER('%aircraft%') OR LOWER(name) LIKE LOWER('%avionics%') OR LOWER(name) LIKE LOWER('%turbine%') OR LOWER(name) LIKE LOWER('%engine%') OR LOWER(operator) LIKE LOWER('%aerospace%') OR LOWER(operator) LIKE LOWER('%aviation%') OR LOWER(operator) LIKE LOWER('%aircraft%') OR LOWER(operator) LIKE LOWER('%avionics%') OR LOWER(operator) LIKE LOWER('%turbine%') OR LOWER(operator) LIKE LOWER('%engine%') OR LOWER(brand) LIKE LOWER('%aerospace%') OR LOWER(brand) LIKE LOWER('%aviation%') OR LOWER(brand) LIKE LOWER('%aircraft%') OR LOWER(brand) LIKE LOWER('%avionics%') OR LOWER(brand) LIKE LOWER('%turbine%') OR LOWER(brand) LIKE LOWER('%engine%')) THEN 30 ELSE 0 END +
    CASE WHEN (LOWER(name) LIKE LOWER('%precision%') OR LOWER(name) LIKE LOWER('%machining%') OR LOWER(name) LIKE LOWER('%casting%') OR LOWER(name) LIKE LOWER('%forging%') OR LOWER(name) LIKE LOWER('%composite%') OR LOWER(name) LIKE LOWER('%materials%') OR LOWER(operator) LIKE LOWER('%precision%') OR LOWER(operator) LIKE LOWER('%machining%') OR LOWER(operator) LIKE LOWER('%casting%') OR LOWER(operator) LIKE LOWER('%forging%') OR LOWER(operator) LIKE LOWER('%composite%') OR LOWER(operator) LIKE LOWER('%materials%') OR LOWER(brand) LIKE LOWER('%precision%') OR LOWER(brand) LIKE LOWER('%machining%') OR LOWER(brand) LIKE LOWER('%casting%') OR LOWER(brand) LIKE LOWER('%forging%') OR LOWER(brand) LIKE LOWER('%composite%') OR LOWER(brand) LIKE LOWER('%materials%')) THEN 20 ELSE 0 END +
    CASE WHEN (LOWER(name) LIKE LOWER('%engineering%') OR LOWER(name) LIKE LOWER('%technology%') OR LOWER(name) LIKE LOWER('%systems%') OR LOWER(name) LIKE LOWER('%electronics%') OR LOWER(name) LIKE LOWER('%software%') OR LOWER(name) LIKE LOWER('%control%') OR LOWER(operator) LIKE LOWER('%engineering%') OR LOWER(operator) LIKE LOWER('%technology%') OR LOWER(operator) LIKE LOWER('%systems%') OR LOWER(operator) LIKE LOWER('%electronics%') OR LOWER(operator) LIKE LOWER('%software%') OR LOWER(operator) LIKE LOWER('%control%') OR LOWER(brand) LIKE LOWER('%engineering%') OR LOWER(brand) LIKE LOWER('%technology%') OR LOWER(brand) LIKE LOWER('%systems%') OR LOWER(brand) LIKE LOWER('%electronics%') OR LOWER(brand) LIKE LOWER('%software%') OR LOWER(brand) LIKE LOWER('%control%')) THEN 25 ELSE 0 END +
    CASE WHEN (operator IN ('l', 't')) THEN -30 ELSE 0 END +
    CASE WHEN (operator IN ('g', 't')) THEN -40 ELSE 0 END
) AS aerospace_score,
    array_remove(ARRAY[CASE WHEN (LOWER(name) LIKE LOWER('%boeing%') OR LOWER(operator) LIKE LOWER('%boeing%') OR LOWER(brand) LIKE LOWER('%boeing%')) THEN 'boeing' END, CASE WHEN (LOWER(name) LIKE LOWER('%airbus%') OR LOWER(operator) LIKE LOWER('%airbus%') OR LOWER(brand) LIKE LOWER('%airbus%')) THEN 'airbus' END, CASE WHEN (LOWER(name) LIKE LOWER('%rolls royce%') OR LOWER(operator) LIKE LOWER('%rolls royce%') OR LOWER(brand) LIKE LOWER('%rolls royce%')) THEN 'rolls royce' END, CASE WHEN (LOWER(name) LIKE LOWER('%bae systems%') OR LOWER(operator) LIKE LOWER('%bae systems%') OR LOWER(brand) LIKE LOWER('%bae systems%')) THEN 'bae systems' END, CASE WHEN (LOWER(name) LIKE LOWER('%leonardo%') OR LOWER(operator) LIKE LOWER('%leonardo%') OR LOWER(brand) LIKE LOWER('%leonardo%')) THEN 'leonardo' END, CASE WHEN (LOWER(name) LIKE LOWER('%thales%') OR LOWER(operator) LIKE LOWER('%thales%') OR LOWER(brand) LIKE LOWER('%thales%')) THEN 'thales' END, CASE WHEN (LOWER(name) LIKE LOWER('%safran%') OR LOWER(operator) LIKE LOWER('%safran%') OR LOWER(brand) LIKE LOWER('%safran%')) THEN 'safran' END, CASE WHEN (LOWER(name) LIKE LOWER('%aerospace%') OR LOWER(operator) LIKE LOWER('%aerospace%') OR LOWER(brand) LIKE LOWER('%aerospace%')) THEN 'aerospace' END, CASE WHEN (LOWER(name) LIKE LOWER('%aviation%') OR LOWER(operator) LIKE LOWER('%aviation%') OR LOWER(brand) LIKE LOWER('%aviation%')) THEN 'aviation' END, CASE WHEN (LOWER(name) LIKE LOWER('%aircraft%') OR LOWER(operator) LIKE LOWER('%aircraft%') OR LOWER(brand) LIKE LOWER('%aircraft%')) THEN 'aircraft' END, CASE WHEN (LOWER(name) LIKE LOWER('%avionics%') OR LOWER(operator) LIKE LOWER('%avionics%') OR LOWER(brand) LIKE LOWER('%avionics%')) THEN 'avionics' END, CASE WHEN (LOWER(name) LIKE LOWER('%turbine%') OR LOWER(operator) LIKE LOWER('%turbine%') OR LOWER(brand) LIKE LOWER('%turbine%')) THEN 'turbine' END, CASE WHEN (LOWER(name) LIKE LOWER('%engine%') OR LOWER(operator) LIKE LOWER('%engine%') OR LOWER(brand) LIKE LOWER('%engine%')) THEN 'engine' END, CASE WHEN (LOWER(name) LIKE LOWER('%precision%') OR LOWER(operator) LIKE LOWER('%precision%') OR LOWER(brand) LIKE LOWER('%precision%')) THEN 'precision' END, CASE WHEN (LOWER(name) LIKE LOWER('%machining%') OR LOWER(operator) LIKE LOWER('%machining%') OR LOWER(brand) LIKE LOWER('%machining%')) THEN 'machining' END, CASE WHEN (LOWER(name) LIKE LOWER('%casting%') OR LOWER(operator) LIKE LOWER('%casting%') OR LOWER(brand) LIKE LOWER('%casting%')) THEN 'casting' END, CASE WHEN (LOWER(name) LIKE LOWER('%forging%') OR LOWER(operator) LIKE LOWER('%forging%') OR LOWER(brand) LIKE LOWER('%forging%')) THEN 'forging' END, CASE WHEN (LOWER(name) LIKE LOWER('%composite%') OR LOWER(operator) LIKE LOWER('%composite%') OR LOWER(brand) LIKE LOWER('%composite%')) THEN 'composite' END, CASE WHEN (LOWER(name) LIKE LOWER('%materials%') OR LOWER(operator) LIKE LOWER('%materials%') OR LOWER(brand) LIKE LOWER('%materials%')) THEN 'materials' END, CASE WHEN (LOWER(name) LIKE LOWER('%engineering%') OR LOWER(operator) LIKE LOWER('%engineering%') OR LOWER(brand) LIKE LOWER('%engineering%')) THEN 'engineering' END, CASE WHEN (LOWER(name) LIKE LOWER('%technology%') OR LOWER(operator) LIKE LOWER('%technology%') OR LOWER(brand) LIKE LOWER('%technology%')) THEN 'technology' END, CASE WHEN (LOWER(name) LIKE LOWER('%systems%') OR LOWER(operator) LIKE LOWER('%systems%') OR LOWER(brand) LIKE LOWER('%systems%')) THEN 'systems' END, CASE WHEN (LOWER(name) LIKE LOWER('%electronics%') OR LOWER(operator) LIKE LOWER('%electronics%') OR LOWER(brand) LIKE LOWER('%electronics%')) THEN 'electronics' END, CASE WHEN (LOWER(name) LIKE LOWER('%software%') OR LOWER(operator) LIKE LOWER('%software%') OR LOWER(brand) LIKE LOWER('%software%')) THEN 'software' END, CASE WHEN (LOWER(name) LIKE LOWER('%control%') OR LOWER(operator) LIKE LOWER('%control%') OR LOWER(brand) LIKE LOWER('%control%')) THEN 'control' END], NULL) AS matched_keywords,
    'planet_osm_point' AS source_table
FROM public.planet_osm_point_aerospace_filtered
WHERE aerospace_score > 0;

-- Scoring for planet_osm_line
SELECT *,
    (
    CASE
    WHEN (operator IN ('i', 's', '_', 'n', 'o', 't', '_', 'n', 'u', 'l', 'l')) THEN 80
    WHEN (operator IN ('i', 's', '_', 'n', 'o', 't', '_', 'n', 'u', 'l', 'l')) THEN 50
    ELSE 0
END +
    CASE WHEN (LOWER(name) LIKE LOWER('%boeing%') OR LOWER(name) LIKE LOWER('%airbus%') OR LOWER(name) LIKE LOWER('%rolls royce%') OR LOWER(name) LIKE LOWER('%bae systems%') OR LOWER(name) LIKE LOWER('%leonardo%') OR LOWER(name) LIKE LOWER('%thales%') OR LOWER(name) LIKE LOWER('%safran%') OR LOWER(operator) LIKE LOWER('%boeing%') OR LOWER(operator) LIKE LOWER('%airbus%') OR LOWER(operator) LIKE LOWER('%rolls royce%') OR LOWER(operator) LIKE LOWER('%bae systems%') OR LOWER(operator) LIKE LOWER('%leonardo%') OR LOWER(operator) LIKE LOWER('%thales%') OR LOWER(operator) LIKE LOWER('%safran%') OR LOWER(brand) LIKE LOWER('%boeing%') OR LOWER(brand) LIKE LOWER('%airbus%') OR LOWER(brand) LIKE LOWER('%rolls royce%') OR LOWER(brand) LIKE LOWER('%bae systems%') OR LOWER(brand) LIKE LOWER('%leonardo%') OR LOWER(brand) LIKE LOWER('%thales%') OR LOWER(brand) LIKE LOWER('%safran%')) THEN 50 ELSE 0 END +
    CASE WHEN (LOWER(name) LIKE LOWER('%aerospace%') OR LOWER(name) LIKE LOWER('%aviation%') OR LOWER(name) LIKE LOWER('%aircraft%') OR LOWER(name) LIKE LOWER('%avionics%') OR LOWER(name) LIKE LOWER('%turbine%') OR LOWER(name) LIKE LOWER('%engine%') OR LOWER(operator) LIKE LOWER('%aerospace%') OR LOWER(operator) LIKE LOWER('%aviation%') OR LOWER(operator) LIKE LOWER('%aircraft%') OR LOWER(operator) LIKE LOWER('%avionics%') OR LOWER(operator) LIKE LOWER('%turbine%') OR LOWER(operator) LIKE LOWER('%engine%') OR LOWER(brand) LIKE LOWER('%aerospace%') OR LOWER(brand) LIKE LOWER('%aviation%') OR LOWER(brand) LIKE LOWER('%aircraft%') OR LOWER(brand) LIKE LOWER('%avionics%') OR LOWER(brand) LIKE LOWER('%turbine%') OR LOWER(brand) LIKE LOWER('%engine%')) THEN 30 ELSE 0 END +
    CASE WHEN (LOWER(name) LIKE LOWER('%precision%') OR LOWER(name) LIKE LOWER('%machining%') OR LOWER(name) LIKE LOWER('%casting%') OR LOWER(name) LIKE LOWER('%forging%') OR LOWER(name) LIKE LOWER('%composite%') OR LOWER(name) LIKE LOWER('%materials%') OR LOWER(operator) LIKE LOWER('%precision%') OR LOWER(operator) LIKE LOWER('%machining%') OR LOWER(operator) LIKE LOWER('%casting%') OR LOWER(operator) LIKE LOWER('%forging%') OR LOWER(operator) LIKE LOWER('%composite%') OR LOWER(operator) LIKE LOWER('%materials%') OR LOWER(brand) LIKE LOWER('%precision%') OR LOWER(brand) LIKE LOWER('%machining%') OR LOWER(brand) LIKE LOWER('%casting%') OR LOWER(brand) LIKE LOWER('%forging%') OR LOWER(brand) LIKE LOWER('%composite%') OR LOWER(brand) LIKE LOWER('%materials%')) THEN 20 ELSE 0 END +
    CASE WHEN (LOWER(name) LIKE LOWER('%engineering%') OR LOWER(name) LIKE LOWER('%technology%') OR LOWER(name) LIKE LOWER('%systems%') OR LOWER(name) LIKE LOWER('%electronics%') OR LOWER(name) LIKE LOWER('%software%') OR LOWER(name) LIKE LOWER('%control%') OR LOWER(operator) LIKE LOWER('%engineering%') OR LOWER(operator) LIKE LOWER('%technology%') OR LOWER(operator) LIKE LOWER('%systems%') OR LOWER(operator) LIKE LOWER('%electronics%') OR LOWER(operator) LIKE LOWER('%software%') OR LOWER(operator) LIKE LOWER('%control%') OR LOWER(brand) LIKE LOWER('%engineering%') OR LOWER(brand) LIKE LOWER('%technology%') OR LOWER(brand) LIKE LOWER('%systems%') OR LOWER(brand) LIKE LOWER('%electronics%') OR LOWER(brand) LIKE LOWER('%software%') OR LOWER(brand) LIKE LOWER('%control%')) THEN 25 ELSE 0 END +
    CASE WHEN (operator IN ('l', 't')) THEN -30 ELSE 0 END +
    CASE WHEN (operator IN ('g', 't')) THEN -40 ELSE 0 END
) AS aerospace_score,
    array_remove(ARRAY[CASE WHEN (LOWER(name) LIKE LOWER('%boeing%') OR LOWER(operator) LIKE LOWER('%boeing%') OR LOWER(brand) LIKE LOWER('%boeing%')) THEN 'boeing' END, CASE WHEN (LOWER(name) LIKE LOWER('%airbus%') OR LOWER(operator) LIKE LOWER('%airbus%') OR LOWER(brand) LIKE LOWER('%airbus%')) THEN 'airbus' END, CASE WHEN (LOWER(name) LIKE LOWER('%rolls royce%') OR LOWER(operator) LIKE LOWER('%rolls royce%') OR LOWER(brand) LIKE LOWER('%rolls royce%')) THEN 'rolls royce' END, CASE WHEN (LOWER(name) LIKE LOWER('%bae systems%') OR LOWER(operator) LIKE LOWER('%bae systems%') OR LOWER(brand) LIKE LOWER('%bae systems%')) THEN 'bae systems' END, CASE WHEN (LOWER(name) LIKE LOWER('%leonardo%') OR LOWER(operator) LIKE LOWER('%leonardo%') OR LOWER(brand) LIKE LOWER('%leonardo%')) THEN 'leonardo' END, CASE WHEN (LOWER(name) LIKE LOWER('%thales%') OR LOWER(operator) LIKE LOWER('%thales%') OR LOWER(brand) LIKE LOWER('%thales%')) THEN 'thales' END, CASE WHEN (LOWER(name) LIKE LOWER('%safran%') OR LOWER(operator) LIKE LOWER('%safran%') OR LOWER(brand) LIKE LOWER('%safran%')) THEN 'safran' END, CASE WHEN (LOWER(name) LIKE LOWER('%aerospace%') OR LOWER(operator) LIKE LOWER('%aerospace%') OR LOWER(brand) LIKE LOWER('%aerospace%')) THEN 'aerospace' END, CASE WHEN (LOWER(name) LIKE LOWER('%aviation%') OR LOWER(operator) LIKE LOWER('%aviation%') OR LOWER(brand) LIKE LOWER('%aviation%')) THEN 'aviation' END, CASE WHEN (LOWER(name) LIKE LOWER('%aircraft%') OR LOWER(operator) LIKE LOWER('%aircraft%') OR LOWER(brand) LIKE LOWER('%aircraft%')) THEN 'aircraft' END, CASE WHEN (LOWER(name) LIKE LOWER('%avionics%') OR LOWER(operator) LIKE LOWER('%avionics%') OR LOWER(brand) LIKE LOWER('%avionics%')) THEN 'avionics' END, CASE WHEN (LOWER(name) LIKE LOWER('%turbine%') OR LOWER(operator) LIKE LOWER('%turbine%') OR LOWER(brand) LIKE LOWER('%turbine%')) THEN 'turbine' END, CASE WHEN (LOWER(name) LIKE LOWER('%engine%') OR LOWER(operator) LIKE LOWER('%engine%') OR LOWER(brand) LIKE LOWER('%engine%')) THEN 'engine' END, CASE WHEN (LOWER(name) LIKE LOWER('%precision%') OR LOWER(operator) LIKE LOWER('%precision%') OR LOWER(brand) LIKE LOWER('%precision%')) THEN 'precision' END, CASE WHEN (LOWER(name) LIKE LOWER('%machining%') OR LOWER(operator) LIKE LOWER('%machining%') OR LOWER(brand) LIKE LOWER('%machining%')) THEN 'machining' END, CASE WHEN (LOWER(name) LIKE LOWER('%casting%') OR LOWER(operator) LIKE LOWER('%casting%') OR LOWER(brand) LIKE LOWER('%casting%')) THEN 'casting' END, CASE WHEN (LOWER(name) LIKE LOWER('%forging%') OR LOWER(operator) LIKE LOWER('%forging%') OR LOWER(brand) LIKE LOWER('%forging%')) THEN 'forging' END, CASE WHEN (LOWER(name) LIKE LOWER('%composite%') OR LOWER(operator) LIKE LOWER('%composite%') OR LOWER(brand) LIKE LOWER('%composite%')) THEN 'composite' END, CASE WHEN (LOWER(name) LIKE LOWER('%materials%') OR LOWER(operator) LIKE LOWER('%materials%') OR LOWER(brand) LIKE LOWER('%materials%')) THEN 'materials' END, CASE WHEN (LOWER(name) LIKE LOWER('%engineering%') OR LOWER(operator) LIKE LOWER('%engineering%') OR LOWER(brand) LIKE LOWER('%engineering%')) THEN 'engineering' END, CASE WHEN (LOWER(name) LIKE LOWER('%technology%') OR LOWER(operator) LIKE LOWER('%technology%') OR LOWER(brand) LIKE LOWER('%technology%')) THEN 'technology' END, CASE WHEN (LOWER(name) LIKE LOWER('%systems%') OR LOWER(operator) LIKE LOWER('%systems%') OR LOWER(brand) LIKE LOWER('%systems%')) THEN 'systems' END, CASE WHEN (LOWER(name) LIKE LOWER('%electronics%') OR LOWER(operator) LIKE LOWER('%electronics%') OR LOWER(brand) LIKE LOWER('%electronics%')) THEN 'electronics' END, CASE WHEN (LOWER(name) LIKE LOWER('%software%') OR LOWER(operator) LIKE LOWER('%software%') OR LOWER(brand) LIKE LOWER('%software%')) THEN 'software' END, CASE WHEN (LOWER(name) LIKE LOWER('%control%') OR LOWER(operator) LIKE LOWER('%control%') OR LOWER(brand) LIKE LOWER('%control%')) THEN 'control' END], NULL) AS matched_keywords,
    'planet_osm_line' AS source_table
FROM public.planet_osm_line_aerospace_filtered
WHERE aerospace_score > 0;

-- Scoring for planet_osm_polygon
SELECT *,
    (
    CASE
    WHEN (operator IN ('i', 's', '_', 'n', 'o', 't', '_', 'n', 'u', 'l', 'l')) THEN 80
    WHEN (operator IN ('i', 's', '_', 'n', 'o', 't', '_', 'n', 'u', 'l', 'l')) THEN 50
    ELSE 0
END +
    CASE WHEN (LOWER(name) LIKE LOWER('%boeing%') OR LOWER(name) LIKE LOWER('%airbus%') OR LOWER(name) LIKE LOWER('%rolls royce%') OR LOWER(name) LIKE LOWER('%bae systems%') OR LOWER(name) LIKE LOWER('%leonardo%') OR LOWER(name) LIKE LOWER('%thales%') OR LOWER(name) LIKE LOWER('%safran%') OR LOWER(operator) LIKE LOWER('%boeing%') OR LOWER(operator) LIKE LOWER('%airbus%') OR LOWER(operator) LIKE LOWER('%rolls royce%') OR LOWER(operator) LIKE LOWER('%bae systems%') OR LOWER(operator) LIKE LOWER('%leonardo%') OR LOWER(operator) LIKE LOWER('%thales%') OR LOWER(operator) LIKE LOWER('%safran%') OR LOWER(brand) LIKE LOWER('%boeing%') OR LOWER(brand) LIKE LOWER('%airbus%') OR LOWER(brand) LIKE LOWER('%rolls royce%') OR LOWER(brand) LIKE LOWER('%bae systems%') OR LOWER(brand) LIKE LOWER('%leonardo%') OR LOWER(brand) LIKE LOWER('%thales%') OR LOWER(brand) LIKE LOWER('%safran%')) THEN 50 ELSE 0 END +
    CASE WHEN (LOWER(name) LIKE LOWER('%aerospace%') OR LOWER(name) LIKE LOWER('%aviation%') OR LOWER(name) LIKE LOWER('%aircraft%') OR LOWER(name) LIKE LOWER('%avionics%') OR LOWER(name) LIKE LOWER('%turbine%') OR LOWER(name) LIKE LOWER('%engine%') OR LOWER(operator) LIKE LOWER('%aerospace%') OR LOWER(operator) LIKE LOWER('%aviation%') OR LOWER(operator) LIKE LOWER('%aircraft%') OR LOWER(operator) LIKE LOWER('%avionics%') OR LOWER(operator) LIKE LOWER('%turbine%') OR LOWER(operator) LIKE LOWER('%engine%') OR LOWER(brand) LIKE LOWER('%aerospace%') OR LOWER(brand) LIKE LOWER('%aviation%') OR LOWER(brand) LIKE LOWER('%aircraft%') OR LOWER(brand) LIKE LOWER('%avionics%') OR LOWER(brand) LIKE LOWER('%turbine%') OR LOWER(brand) LIKE LOWER('%engine%')) THEN 30 ELSE 0 END +
    CASE WHEN (LOWER(name) LIKE LOWER('%precision%') OR LOWER(name) LIKE LOWER('%machining%') OR LOWER(name) LIKE LOWER('%casting%') OR LOWER(name) LIKE LOWER('%forging%') OR LOWER(name) LIKE LOWER('%composite%') OR LOWER(name) LIKE LOWER('%materials%') OR LOWER(operator) LIKE LOWER('%precision%') OR LOWER(operator) LIKE LOWER('%machining%') OR LOWER(operator) LIKE LOWER('%casting%') OR LOWER(operator) LIKE LOWER('%forging%') OR LOWER(operator) LIKE LOWER('%composite%') OR LOWER(operator) LIKE LOWER('%materials%') OR LOWER(brand) LIKE LOWER('%precision%') OR LOWER(brand) LIKE LOWER('%machining%') OR LOWER(brand) LIKE LOWER('%casting%') OR LOWER(brand) LIKE LOWER('%forging%') OR LOWER(brand) LIKE LOWER('%composite%') OR LOWER(brand) LIKE LOWER('%materials%')) THEN 20 ELSE 0 END +
    CASE WHEN (LOWER(name) LIKE LOWER('%engineering%') OR LOWER(name) LIKE LOWER('%technology%') OR LOWER(name) LIKE LOWER('%systems%') OR LOWER(name) LIKE LOWER('%electronics%') OR LOWER(name) LIKE LOWER('%software%') OR LOWER(name) LIKE LOWER('%control%') OR LOWER(operator) LIKE LOWER('%engineering%') OR LOWER(operator) LIKE LOWER('%technology%') OR LOWER(operator) LIKE LOWER('%systems%') OR LOWER(operator) LIKE LOWER('%electronics%') OR LOWER(operator) LIKE LOWER('%software%') OR LOWER(operator) LIKE LOWER('%control%') OR LOWER(brand) LIKE LOWER('%engineering%') OR LOWER(brand) LIKE LOWER('%technology%') OR LOWER(brand) LIKE LOWER('%systems%') OR LOWER(brand) LIKE LOWER('%electronics%') OR LOWER(brand) LIKE LOWER('%software%') OR LOWER(brand) LIKE LOWER('%control%')) THEN 25 ELSE 0 END +
    CASE WHEN (operator IN ('l', 't')) THEN -30 ELSE 0 END +
    CASE WHEN (operator IN ('g', 't')) THEN -40 ELSE 0 END
) AS aerospace_score,
    array_remove(ARRAY[CASE WHEN (LOWER(name) LIKE LOWER('%boeing%') OR LOWER(operator) LIKE LOWER('%boeing%') OR LOWER(brand) LIKE LOWER('%boeing%')) THEN 'boeing' END, CASE WHEN (LOWER(name) LIKE LOWER('%airbus%') OR LOWER(operator) LIKE LOWER('%airbus%') OR LOWER(brand) LIKE LOWER('%airbus%')) THEN 'airbus' END, CASE WHEN (LOWER(name) LIKE LOWER('%rolls royce%') OR LOWER(operator) LIKE LOWER('%rolls royce%') OR LOWER(brand) LIKE LOWER('%rolls royce%')) THEN 'rolls royce' END, CASE WHEN (LOWER(name) LIKE LOWER('%bae systems%') OR LOWER(operator) LIKE LOWER('%bae systems%') OR LOWER(brand) LIKE LOWER('%bae systems%')) THEN 'bae systems' END, CASE WHEN (LOWER(name) LIKE LOWER('%leonardo%') OR LOWER(operator) LIKE LOWER('%leonardo%') OR LOWER(brand) LIKE LOWER('%leonardo%')) THEN 'leonardo' END, CASE WHEN (LOWER(name) LIKE LOWER('%thales%') OR LOWER(operator) LIKE LOWER('%thales%') OR LOWER(brand) LIKE LOWER('%thales%')) THEN 'thales' END, CASE WHEN (LOWER(name) LIKE LOWER('%safran%') OR LOWER(operator) LIKE LOWER('%safran%') OR LOWER(brand) LIKE LOWER('%safran%')) THEN 'safran' END, CASE WHEN (LOWER(name) LIKE LOWER('%aerospace%') OR LOWER(operator) LIKE LOWER('%aerospace%') OR LOWER(brand) LIKE LOWER('%aerospace%')) THEN 'aerospace' END, CASE WHEN (LOWER(name) LIKE LOWER('%aviation%') OR LOWER(operator) LIKE LOWER('%aviation%') OR LOWER(brand) LIKE LOWER('%aviation%')) THEN 'aviation' END, CASE WHEN (LOWER(name) LIKE LOWER('%aircraft%') OR LOWER(operator) LIKE LOWER('%aircraft%') OR LOWER(brand) LIKE LOWER('%aircraft%')) THEN 'aircraft' END, CASE WHEN (LOWER(name) LIKE LOWER('%avionics%') OR LOWER(operator) LIKE LOWER('%avionics%') OR LOWER(brand) LIKE LOWER('%avionics%')) THEN 'avionics' END, CASE WHEN (LOWER(name) LIKE LOWER('%turbine%') OR LOWER(operator) LIKE LOWER('%turbine%') OR LOWER(brand) LIKE LOWER('%turbine%')) THEN 'turbine' END, CASE WHEN (LOWER(name) LIKE LOWER('%engine%') OR LOWER(operator) LIKE LOWER('%engine%') OR LOWER(brand) LIKE LOWER('%engine%')) THEN 'engine' END, CASE WHEN (LOWER(name) LIKE LOWER('%precision%') OR LOWER(operator) LIKE LOWER('%precision%') OR LOWER(brand) LIKE LOWER('%precision%')) THEN 'precision' END, CASE WHEN (LOWER(name) LIKE LOWER('%machining%') OR LOWER(operator) LIKE LOWER('%machining%') OR LOWER(brand) LIKE LOWER('%machining%')) THEN 'machining' END, CASE WHEN (LOWER(name) LIKE LOWER('%casting%') OR LOWER(operator) LIKE LOWER('%casting%') OR LOWER(brand) LIKE LOWER('%casting%')) THEN 'casting' END, CASE WHEN (LOWER(name) LIKE LOWER('%forging%') OR LOWER(operator) LIKE LOWER('%forging%') OR LOWER(brand) LIKE LOWER('%forging%')) THEN 'forging' END, CASE WHEN (LOWER(name) LIKE LOWER('%composite%') OR LOWER(operator) LIKE LOWER('%composite%') OR LOWER(brand) LIKE LOWER('%composite%')) THEN 'composite' END, CASE WHEN (LOWER(name) LIKE LOWER('%materials%') OR LOWER(operator) LIKE LOWER('%materials%') OR LOWER(brand) LIKE LOWER('%materials%')) THEN 'materials' END, CASE WHEN (LOWER(name) LIKE LOWER('%engineering%') OR LOWER(operator) LIKE LOWER('%engineering%') OR LOWER(brand) LIKE LOWER('%engineering%')) THEN 'engineering' END, CASE WHEN (LOWER(name) LIKE LOWER('%technology%') OR LOWER(operator) LIKE LOWER('%technology%') OR LOWER(brand) LIKE LOWER('%technology%')) THEN 'technology' END, CASE WHEN (LOWER(name) LIKE LOWER('%systems%') OR LOWER(operator) LIKE LOWER('%systems%') OR LOWER(brand) LIKE LOWER('%systems%')) THEN 'systems' END, CASE WHEN (LOWER(name) LIKE LOWER('%electronics%') OR LOWER(operator) LIKE LOWER('%electronics%') OR LOWER(brand) LIKE LOWER('%electronics%')) THEN 'electronics' END, CASE WHEN (LOWER(name) LIKE LOWER('%software%') OR LOWER(operator) LIKE LOWER('%software%') OR LOWER(brand) LIKE LOWER('%software%')) THEN 'software' END, CASE WHEN (LOWER(name) LIKE LOWER('%control%') OR LOWER(operator) LIKE LOWER('%control%') OR LOWER(brand) LIKE LOWER('%control%')) THEN 'control' END], NULL) AS matched_keywords,
    'planet_osm_polygon' AS source_table
FROM public.planet_osm_polygon_aerospace_filtered
WHERE aerospace_score > 0;

-- Scoring for planet_osm_roads
SELECT *,
    (
    CASE
    WHEN (operator IN ('i', 's', '_', 'n', 'o', 't', '_', 'n', 'u', 'l', 'l')) THEN 80
    WHEN (operator IN ('i', 's', '_', 'n', 'o', 't', '_', 'n', 'u', 'l', 'l')) THEN 50
    ELSE 0
END +
    CASE WHEN (LOWER(name) LIKE LOWER('%boeing%') OR LOWER(name) LIKE LOWER('%airbus%') OR LOWER(name) LIKE LOWER('%rolls royce%') OR LOWER(name) LIKE LOWER('%bae systems%') OR LOWER(name) LIKE LOWER('%leonardo%') OR LOWER(name) LIKE LOWER('%thales%') OR LOWER(name) LIKE LOWER('%safran%') OR LOWER(operator) LIKE LOWER('%boeing%') OR LOWER(operator) LIKE LOWER('%airbus%') OR LOWER(operator) LIKE LOWER('%rolls royce%') OR LOWER(operator) LIKE LOWER('%bae systems%') OR LOWER(operator) LIKE LOWER('%leonardo%') OR LOWER(operator) LIKE LOWER('%thales%') OR LOWER(operator) LIKE LOWER('%safran%') OR LOWER(brand) LIKE LOWER('%boeing%') OR LOWER(brand) LIKE LOWER('%airbus%') OR LOWER(brand) LIKE LOWER('%rolls royce%') OR LOWER(brand) LIKE LOWER('%bae systems%') OR LOWER(brand) LIKE LOWER('%leonardo%') OR LOWER(brand) LIKE LOWER('%thales%') OR LOWER(brand) LIKE LOWER('%safran%')) THEN 50 ELSE 0 END +
    CASE WHEN (LOWER(name) LIKE LOWER('%aerospace%') OR LOWER(name) LIKE LOWER('%aviation%') OR LOWER(name) LIKE LOWER('%aircraft%') OR LOWER(name) LIKE LOWER('%avionics%') OR LOWER(name) LIKE LOWER('%turbine%') OR LOWER(name) LIKE LOWER('%engine%') OR LOWER(operator) LIKE LOWER('%aerospace%') OR LOWER(operator) LIKE LOWER('%aviation%') OR LOWER(operator) LIKE LOWER('%aircraft%') OR LOWER(operator) LIKE LOWER('%avionics%') OR LOWER(operator) LIKE LOWER('%turbine%') OR LOWER(operator) LIKE LOWER('%engine%') OR LOWER(brand) LIKE LOWER('%aerospace%') OR LOWER(brand) LIKE LOWER('%aviation%') OR LOWER(brand) LIKE LOWER('%aircraft%') OR LOWER(brand) LIKE LOWER('%avionics%') OR LOWER(brand) LIKE LOWER('%turbine%') OR LOWER(brand) LIKE LOWER('%engine%')) THEN 30 ELSE 0 END +
    CASE WHEN (LOWER(name) LIKE LOWER('%precision%') OR LOWER(name) LIKE LOWER('%machining%') OR LOWER(name) LIKE LOWER('%casting%') OR LOWER(name) LIKE LOWER('%forging%') OR LOWER(name) LIKE LOWER('%composite%') OR LOWER(name) LIKE LOWER('%materials%') OR LOWER(operator) LIKE LOWER('%precision%') OR LOWER(operator) LIKE LOWER('%machining%') OR LOWER(operator) LIKE LOWER('%casting%') OR LOWER(operator) LIKE LOWER('%forging%') OR LOWER(operator) LIKE LOWER('%composite%') OR LOWER(operator) LIKE LOWER('%materials%') OR LOWER(brand) LIKE LOWER('%precision%') OR LOWER(brand) LIKE LOWER('%machining%') OR LOWER(brand) LIKE LOWER('%casting%') OR LOWER(brand) LIKE LOWER('%forging%') OR LOWER(brand) LIKE LOWER('%composite%') OR LOWER(brand) LIKE LOWER('%materials%')) THEN 20 ELSE 0 END +
    CASE WHEN (LOWER(name) LIKE LOWER('%engineering%') OR LOWER(name) LIKE LOWER('%technology%') OR LOWER(name) LIKE LOWER('%systems%') OR LOWER(name) LIKE LOWER('%electronics%') OR LOWER(name) LIKE LOWER('%software%') OR LOWER(name) LIKE LOWER('%control%') OR LOWER(operator) LIKE LOWER('%engineering%') OR LOWER(operator) LIKE LOWER('%technology%') OR LOWER(operator) LIKE LOWER('%systems%') OR LOWER(operator) LIKE LOWER('%electronics%') OR LOWER(operator) LIKE LOWER('%software%') OR LOWER(operator) LIKE LOWER('%control%') OR LOWER(brand) LIKE LOWER('%engineering%') OR LOWER(brand) LIKE LOWER('%technology%') OR LOWER(brand) LIKE LOWER('%systems%') OR LOWER(brand) LIKE LOWER('%electronics%') OR LOWER(brand) LIKE LOWER('%software%') OR LOWER(brand) LIKE LOWER('%control%')) THEN 25 ELSE 0 END +
    CASE WHEN (operator IN ('l', 't')) THEN -30 ELSE 0 END +
    CASE WHEN (operator IN ('g', 't')) THEN -40 ELSE 0 END
) AS aerospace_score,
    array_remove(ARRAY[CASE WHEN (LOWER(name) LIKE LOWER('%boeing%') OR LOWER(operator) LIKE LOWER('%boeing%') OR LOWER(brand) LIKE LOWER('%boeing%')) THEN 'boeing' END, CASE WHEN (LOWER(name) LIKE LOWER('%airbus%') OR LOWER(operator) LIKE LOWER('%airbus%') OR LOWER(brand) LIKE LOWER('%airbus%')) THEN 'airbus' END, CASE WHEN (LOWER(name) LIKE LOWER('%rolls royce%') OR LOWER(operator) LIKE LOWER('%rolls royce%') OR LOWER(brand) LIKE LOWER('%rolls royce%')) THEN 'rolls royce' END, CASE WHEN (LOWER(name) LIKE LOWER('%bae systems%') OR LOWER(operator) LIKE LOWER('%bae systems%') OR LOWER(brand) LIKE LOWER('%bae systems%')) THEN 'bae systems' END, CASE WHEN (LOWER(name) LIKE LOWER('%leonardo%') OR LOWER(operator) LIKE LOWER('%leonardo%') OR LOWER(brand) LIKE LOWER('%leonardo%')) THEN 'leonardo' END, CASE WHEN (LOWER(name) LIKE LOWER('%thales%') OR LOWER(operator) LIKE LOWER('%thales%') OR LOWER(brand) LIKE LOWER('%thales%')) THEN 'thales' END, CASE WHEN (LOWER(name) LIKE LOWER('%safran%') OR LOWER(operator) LIKE LOWER('%safran%') OR LOWER(brand) LIKE LOWER('%safran%')) THEN 'safran' END, CASE WHEN (LOWER(name) LIKE LOWER('%aerospace%') OR LOWER(operator) LIKE LOWER('%aerospace%') OR LOWER(brand) LIKE LOWER('%aerospace%')) THEN 'aerospace' END, CASE WHEN (LOWER(name) LIKE LOWER('%aviation%') OR LOWER(operator) LIKE LOWER('%aviation%') OR LOWER(brand) LIKE LOWER('%aviation%')) THEN 'aviation' END, CASE WHEN (LOWER(name) LIKE LOWER('%aircraft%') OR LOWER(operator) LIKE LOWER('%aircraft%') OR LOWER(brand) LIKE LOWER('%aircraft%')) THEN 'aircraft' END, CASE WHEN (LOWER(name) LIKE LOWER('%avionics%') OR LOWER(operator) LIKE LOWER('%avionics%') OR LOWER(brand) LIKE LOWER('%avionics%')) THEN 'avionics' END, CASE WHEN (LOWER(name) LIKE LOWER('%turbine%') OR LOWER(operator) LIKE LOWER('%turbine%') OR LOWER(brand) LIKE LOWER('%turbine%')) THEN 'turbine' END, CASE WHEN (LOWER(name) LIKE LOWER('%engine%') OR LOWER(operator) LIKE LOWER('%engine%') OR LOWER(brand) LIKE LOWER('%engine%')) THEN 'engine' END, CASE WHEN (LOWER(name) LIKE LOWER('%precision%') OR LOWER(operator) LIKE LOWER('%precision%') OR LOWER(brand) LIKE LOWER('%precision%')) THEN 'precision' END, CASE WHEN (LOWER(name) LIKE LOWER('%machining%') OR LOWER(operator) LIKE LOWER('%machining%') OR LOWER(brand) LIKE LOWER('%machining%')) THEN 'machining' END, CASE WHEN (LOWER(name) LIKE LOWER('%casting%') OR LOWER(operator) LIKE LOWER('%casting%') OR LOWER(brand) LIKE LOWER('%casting%')) THEN 'casting' END, CASE WHEN (LOWER(name) LIKE LOWER('%forging%') OR LOWER(operator) LIKE LOWER('%forging%') OR LOWER(brand) LIKE LOWER('%forging%')) THEN 'forging' END, CASE WHEN (LOWER(name) LIKE LOWER('%composite%') OR LOWER(operator) LIKE LOWER('%composite%') OR LOWER(brand) LIKE LOWER('%composite%')) THEN 'composite' END, CASE WHEN (LOWER(name) LIKE LOWER('%materials%') OR LOWER(operator) LIKE LOWER('%materials%') OR LOWER(brand) LIKE LOWER('%materials%')) THEN 'materials' END, CASE WHEN (LOWER(name) LIKE LOWER('%engineering%') OR LOWER(operator) LIKE LOWER('%engineering%') OR LOWER(brand) LIKE LOWER('%engineering%')) THEN 'engineering' END, CASE WHEN (LOWER(name) LIKE LOWER('%technology%') OR LOWER(operator) LIKE LOWER('%technology%') OR LOWER(brand) LIKE LOWER('%technology%')) THEN 'technology' END, CASE WHEN (LOWER(name) LIKE LOWER('%systems%') OR LOWER(operator) LIKE LOWER('%systems%') OR LOWER(brand) LIKE LOWER('%systems%')) THEN 'systems' END, CASE WHEN (LOWER(name) LIKE LOWER('%electronics%') OR LOWER(operator) LIKE LOWER('%electronics%') OR LOWER(brand) LIKE LOWER('%electronics%')) THEN 'electronics' END, CASE WHEN (LOWER(name) LIKE LOWER('%software%') OR LOWER(operator) LIKE LOWER('%software%') OR LOWER(brand) LIKE LOWER('%software%')) THEN 'software' END, CASE WHEN (LOWER(name) LIKE LOWER('%control%') OR LOWER(operator) LIKE LOWER('%control%') OR LOWER(brand) LIKE LOWER('%control%')) THEN 'control' END], NULL) AS matched_keywords,
    'planet_osm_roads' AS source_table
FROM public.planet_osm_roads_aerospace_filtered
WHERE aerospace_score > 0;
