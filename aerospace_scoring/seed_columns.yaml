# Output table structure and column definitions
output_table:
  name: "aerospace_supplier_candidates"
  description: "Tier-2 aerospace supplier candidates from UK OSM data"

# Core identification columns
identification_columns:
  - column_name: "osm_id"
    source_column: "osm_id"
    data_type: "bigint"
    description: "Original OSM object ID"
    
  - column_name: "osm_type"
    source_column: "source_table"
    data_type: "varchar(50)"
    description: "Source OSM table"
    
  - column_name: "name"
    source_column: "name"
    data_type: "text"
    description: "Primary name"
    fallback_columns: ["operator", "brand"]
    
  - column_name: "operator"
    source_column: "operator"
    data_type: "text"
    description: "Operating company"

# Contact information
contact_columns:
  - column_name: "website"
    source_column: "website"
    data_type: "text"
    description: "Website URL"
    fallback_columns: ["contact:website"]
    
  - column_name: "phone"
    source_column: "phone"
    data_type: "text"
    description: "Phone number"
    fallback_columns: ["contact:phone"]

# Address components
address_columns:
  - column_name: "postcode"
    source_column: "addr:postcode"
    data_type: "varchar(20)"
    description: "UK postal code"
    
  - column_name: "street_address"
    source_column: "addr:street"
    data_type: "text"
    description: "Street address"
    
  - column_name: "city"
    source_column: "addr:city"
    data_type: "text"
    description: "City"
    fallback_columns: ["addr:town"]

# Industrial classification
classification_columns:
  - column_name: "landuse_type"
    source_column: "landuse"
    data_type: "text"
    description: "Land use type"
    
  - column_name: "building_type"
    source_column: "building"
    data_type: "text"
    description: "Building type"
    
  - column_name: "industrial_type"
    source_column: "industrial"
    data_type: "text"
    description: "Industrial type"
    fallback_columns: ["craft"]
    
  - column_name: "office_type"
    source_column: "office"
    data_type: "text"
    description: "Office type"

# Descriptive information
descriptive_columns:
  - column_name: "description"
    source_column: "description"
    data_type: "text"
    description: "Description"

# Spatial data
spatial_columns:
  - column_name: "geometry"
    source_column: "way"
    data_type: "geometry"
    description: "PostGIS geometry"
    
  - column_name: "latitude"
    source_expression: "ST_Y(ST_Transform(ST_Centroid(way), 4326))"
    data_type: "double precision"
    description: "Latitude"
    
  - column_name: "longitude"
    source_expression: "ST_X(ST_Transform(ST_Centroid(way), 4326))"
    data_type: "double precision"
    description: "Longitude"

# Scoring columns
scoring_columns:
  - column_name: "aerospace_score"
    source_expression: "computed"
    data_type: "integer"
    description: "Aerospace relevance score"
    
  - column_name: "tier_classification"
    source_expression: "computed"
    data_type: "varchar(50)"
    description: "Supplier tier"
    
  - column_name: "matched_keywords"
    source_expression: "computed"
    data_type: "text[]"
    description: "Matched keywords"

# Metadata
metadata_columns:
  - column_name: "created_at"
    source_expression: "NOW()"
    data_type: "timestamp"
    description: "Creation timestamp"
    
  - column_name: "confidence_level"
    source_expression: "computed"
    data_type: "varchar(20)"
    description: "Confidence level"
